<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      layout:decorate="~{layout/main-layout}">
<head>
    <title>Blog</title>
</head>
<body>
    <div layout:fragment="content">
        <h2>Blog Posts</h2>
        <div sec:authorize="hasRole('ROLE_ADMIN')" style="margin-bottom:1rem;">
            <a href="/admin/blog/new">Add New Post</a>
        </div>
        <ul>
            <li th:each="post : ${posts}">
                <a th:href="@{/blog/{slug}(slug=${post.slug})}" th:text="${post.title}"></a>
                <span sec:authorize="hasRole('ROLE_ADMIN')">
                    <form th:action="@{/admin/blog/delete/{id}(id=${post.id})}" method="post" style="display:inline;margin-left:0.5rem;">
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                        <button type="submit" onclick="return confirm('Delete this post?');">Delete</button>
                    </form>
                </span>
            </li>
        </ul>
    </div>
</body>
</html>
